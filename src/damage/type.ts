import type { Type, TypesWithStellar } from "./config";

type Effectiveness = 2 | 1 | 0.5 | 0;

type TypeEffectiveness = Record<Type, Effectiveness>;
type TypeEffectivenessMap = Record<Type, TypeEffectiveness>;

const typeAttackEffectivenessMap: TypeEffectivenessMap = {
	Normal: {
		Bug: 1,
		Dark: 1,
		Dragon: 1,
		Electric: 1,
		Fairy: 1,
		Fighting: 1,
		Fire: 1,
		Flying: 1,
		Ghost: 0,
		Grass: 1,
		Ground: 1,
		Ice: 1,
		Normal: 1,
		Poison: 1,
		Psychic: 1,
		Rock: 0.5,
		Steel: 0.5,
		Water: 1,
	},
	Fire: {
		Bug: 2,
		Dark: 1,
		Dragon: 0.5,
		Electric: 1,
		Fairy: 1,
		Fighting: 1,
		Fire: 0.5,
		Flying: 1,
		Ghost: 1,
		Grass: 2,
		Ground: 1,
		Ice: 2,
		Normal: 1,
		Poison: 1,
		Psychic: 1,
		Rock: 0.5,
		Steel: 2,
		Water: 0.5,
	},
	Water: {
		Bug: 1,
		Dark: 1,
		Dragon: 0.5,
		Electric: 1,
		Fairy: 1,
		Fighting: 1,
		Fire: 2,
		Flying: 1,
		Ghost: 1,
		Grass: 0.5,
		Ground: 2,
		Ice: 1,
		Normal: 1,
		Poison: 1,
		Psychic: 1,
		Rock: 2,
		Steel: 1,
		Water: 0.5,
	},
	Grass: {
		Bug: 0.5,
		Dark: 1,
		Dragon: 0.5,
		Electric: 1,
		Fairy: 1,
		Fighting: 1,
		Fire: 0.5,
		Flying: 0.5,
		Ghost: 1,
		Grass: 0.5,
		Ground: 2,
		Ice: 1,
		Normal: 1,
		Poison: 0.5,
		Psychic: 1,
		Rock: 2,
		Steel: 0.5,
		Water: 2,
	},
	Electric: {
		Bug: 1,
		Dark: 1,
		Dragon: 0.5,
		Electric: 0.5,
		Fairy: 1,
		Fighting: 1,
		Fire: 1,
		Flying: 2,
		Ghost: 1,
		Grass: 0.5,
		Ground: 0,
		Ice: 1,
		Normal: 1,
		Poison: 1,
		Psychic: 1,
		Rock: 1,
		Steel: 1,
		Water: 2,
	},
	Ice: {
		Bug: 1,
		Dark: 1,
		Dragon: 2,
		Electric: 1,
		Fairy: 1,
		Fighting: 1,
		Fire: 0.5,
		Flying: 2,
		Ghost: 1,
		Grass: 2,
		Ground: 2,
		Ice: 0.5,
		Normal: 1,
		Poison: 1,
		Psychic: 1,
		Rock: 1,
		Steel: 0.5,
		Water: 0.5,
	},
	Fighting: {
		Bug: 0.5,
		Dark: 1,
		Dragon: 1,
		Electric: 1,
		Fairy: 0.5,
		Fighting: 1,
		Fire: 1,
		Flying: 0.5,
		Ghost: 0,
		Grass: 1,
		Ground: 1,
		Ice: 2,
		Normal: 2,
		Poison: 0.5,
		Psychic: 0.5,
		Rock: 2,
		Steel: 2,
		Water: 1,
	},
	Poison: {
		Bug: 1,
		Dark: 1,
		Dragon: 1,
		Electric: 1,
		Fairy: 2,
		Fighting: 1,
		Fire: 1,
		Flying: 1,
		Ghost: 0.5,
		Grass: 2,
		Ground: 0.5,
		Ice: 1,
		Normal: 1,
		Poison: 0.5,
		Psychic: 1,
		Rock: 0.5,
		Steel: 0,
		Water: 1,
	},
	Ground: {
		Bug: 0.5,
		Dark: 1,
		Dragon: 1,
		Electric: 2,
		Fairy: 1,
		Fighting: 1,
		Fire: 2,
		Flying: 0,
		Ghost: 1,
		Grass: 0.5,
		Ground: 1,
		Ice: 1,
		Normal: 1,
		Poison: 2,
		Psychic: 1,
		Rock: 2,
		Steel: 2,
		Water: 1,
	},
	Flying: {
		Bug: 2,
		Dark: 1,
		Dragon: 1,
		Electric: 0.5,
		Fairy: 1,
		Fighting: 2,
		Fire: 1,
		Flying: 1,
		Ghost: 1,
		Grass: 2,
		Ground: 1,
		Ice: 1,
		Normal: 1,
		Poison: 1,
		Psychic: 1,
		Rock: 0.5,
		Steel: 0.5,
		Water: 1,
	},
	Psychic: {
		Bug: 1,
		Dark: 0,
		Dragon: 1,
		Electric: 1,
		Fairy: 1,
		Fighting: 2,
		Fire: 1,
		Flying: 1,
		Ghost: 1,
		Grass: 1,
		Ground: 1,
		Ice: 1,
		Normal: 1,
		Poison: 2,
		Psychic: 0.5,
		Rock: 1,
		Steel: 0.5,
		Water: 1,
	},
	Bug: {
		Bug: 1,
		Dark: 2,
		Dragon: 1,
		Electric: 1,
		Fairy: 0.5,
		Fighting: 0.5,
		Fire: 0.5,
		Flying: 0.5,
		Ghost: 0.5,
		Grass: 2,
		Ground: 1,
		Ice: 1,
		Normal: 1,
		Poison: 0.5,
		Psychic: 2,
		Rock: 1,
		Steel: 0.5,
		Water: 1,
	},
	Rock: {
		Bug: 2,
		Dark: 1,
		Dragon: 1,
		Electric: 1,
		Fairy: 1,
		Fighting: 0.5,
		Fire: 2,
		Flying: 2,
		Ghost: 1,
		Grass: 1,
		Ground: 0.5,
		Ice: 2,
		Normal: 1,
		Poison: 1,
		Psychic: 1,
		Rock: 1,
		Steel: 0.5,
		Water: 1,
	},
	Ghost: {
		Bug: 1,
		Dark: 0.5,
		Dragon: 1,
		Electric: 1,
		Fairy: 1,
		Fighting: 1,
		Fire: 1,
		Flying: 1,
		Ghost: 1,
		Grass: 1,
		Ground: 1,
		Ice: 1,
		Normal: 0,
		Poison: 1,
		Psychic: 2,
		Rock: 1,
		Steel: 1,
		Water: 1,
	},
	Dragon: {
		Bug: 1,
		Dark: 1,
		Dragon: 2,
		Electric: 1,
		Fairy: 0,
		Fighting: 1,
		Fire: 1,
		Flying: 1,
		Ghost: 1,
		Grass: 1,
		Ground: 1,
		Ice: 1,
		Normal: 1,
		Poison: 1,
		Psychic: 1,
		Rock: 1,
		Steel: 0.5,
		Water: 1,
	},
	Dark: {
		Bug: 1,
		Dark: 0.5,
		Dragon: 1,
		Electric: 1,
		Fairy: 0.5,
		Fighting: 0.5,
		Fire: 1,
		Flying: 1,
		Ghost: 2,
		Grass: 1,
		Ground: 1,
		Ice: 1,
		Normal: 1,
		Poison: 1,
		Psychic: 2,
		Rock: 1,
		Steel: 1,
		Water: 1,
	},
	Steel: {
		Bug: 1,
		Dark: 1,
		Dragon: 1,
		Electric: 0.5,
		Fairy: 1,
		Fighting: 1,
		Fire: 0.5,
		Flying: 1,
		Ghost: 1,
		Grass: 1,
		Ground: 1,
		Ice: 2,
		Normal: 1,
		Poison: 1,
		Psychic: 1,
		Rock: 2,
		Steel: 0.5,
		Water: 0.5,
	},
	Fairy: {
		Bug: 1,
		Dark: 2,
		Dragon: 2,
		Electric: 1,
		Fairy: 1,
		Fighting: 2,
		Fire: 0.5,
		Flying: 1,
		Ghost: 1,
		Grass: 1,
		Ground: 1,
		Ice: 1,
		Normal: 1,
		Poison: 0.5,
		Psychic: 1,
		Rock: 1,
		Steel: 0.5,
		Water: 1,
	},
};

export function getEffectivenessOnPokemon(
	atkType: Type,
	targetPokemonTypes: Array<TypesWithStellar>,
): number {
	return targetPokemonTypes
		.map((type) =>
			type === "Stellar" ? 1 : typeAttackEffectivenessMap[atkType][type],
		)
		.reduce((pre, cur) => pre * cur, 1 as number);
}
